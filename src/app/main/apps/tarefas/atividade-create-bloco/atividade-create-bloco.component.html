<!-- CONTENT -->
<div class="content p-16" fxLayout="column" fxFlex="100">

    <h2>Atividade em bloco de tarefas</h2>

    <h3>{{(tarefas$ | async)?.length}} tarefa(s) selecionada(s), selecione os documentos
    a serem juntados. </h3>
<!--[documentos]="minutas"
*ngFor="let documento of mapDocumentos.get(key).values()"
<div fxLayout="row">
-->

<ng-container *ngFor="let key of mapDocumentos.keys()">
    <div fxLayout="column">
        <mat-card>
            <div fxLayout="row"  fxLayoutGap="12px" >
                <div>
                    <b>{{desmembraKeyMapArray(key).nup  | formatNup}}</b> <br>
                    Tarefa: {{desmembraKeyMapArray(key).idTarefa}} <br> 
                </div>
                <div fxLayout="row">
                    <mat-card-content>    
                        <cdk-documento-card-list 
                                                [componenteChamador]=componenteChamador
                                                [documentos]=mapDocumentos.get(key)
                                                [deletingId]="(deletingDocumentosId$ | async)"
                                                [assinandoId]="(assinandoDocumentosId$ | async)"
                                                [convertendoId]="(convertendoDocumentosId$ | async)"
                                                (delete)="doDelete($event)"
                                                (assinatura)="doAssinatura($event)"
                                                (converte)="doConverte($event)"
                                                (clicked)="onClicked($event)"
                                                (changedSelectedIds)="changedSelectedIds($event)">
                        </cdk-documento-card-list>
                    </mat-card-content>
                </div>
            </div>
        </mat-card>
    </div>
</ng-container>

    <cdk-atividade-form
            [atividade]="atividade"
            [valid]="(tarefas$ | async)?.length > 0"
            [saving]="(isSaving$ | async)"
            (save)="submit($event)">
    </cdk-atividade-form>

    <mat-list *ngIf="operacoes.length > 0" fxFlex>
        <h3 matSubheader>
            <span>Resultado do Bloco</span>
        </h3>

        <mat-list-item *ngFor="let operacao of operacoes">
            <p matLine class="mb-4 p-8 secondary-text"
               [ngClass]="{'light-green-50': operacao.success, 'pink-50': !operacao.success}">{{operacao.content}}</p>
        </mat-list-item>
    </mat-list>

</div>
